<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
  <title>Morpheus - Tutorial</title>
  <link rel="stylesheet" href="css/morpheus-latest.min.css">
  <script type="text/javascript" src="js/morpheus-external-latest.min.js"></script>
  <script src="js/morpheus-latest.min.js"></script>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <div class="col-xs-12">
      <svg width="32px" height="32px">
        <g>
          <rect x="0" y="0" width="32" height="14" style="fill:#ca0020;stroke:none"/>
          <rect x="0" y="18" width="32" height="14" style="fill:#0571b0;stroke:none"/>
        </g>
      </svg>
      <h2 style="padding-left: 4px; display:inline-block;">Tutorial</h2>
      <p>This tutorial uses data from the <a target="_blank"
                                             href="https://depmap.org/portal/">DepMap</a>.</p>
      <hr/>
    </div>
  </div>
  <div id="header" class="row">
    <div class="col-xs-12">
      <input type="button" class="btn btn-default btn-sm"
             value="Expand All" name="expand"> <input type="button"
                                                      class="btn btn-default btn-sm"
                                                      value="Collapse All" name="collapse">
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Open
        Project Achilles Gene Essentiality Scores</a>
      <p class="collapse">Download the <a target="_blank" href="https://ndownloader.figshare.com/files/16757666">CRISPR
        dataset</a>. This dataset facilitates the
        discovery of genes that when knocked down/out effect the viability of particular cell
        lines.<br/>Morpheus can also open data from Excel, text files,
        the clipboard, a URL, and Dropbox.</p>
      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Transpose</a>
      <p class="collapse">Select Tools > Transpose to put the genes on the rows and the cell lines on the columns.</p>


      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Adjust Color Scheme</a>

      <p class="collapse">Select View > Options to edit the color scale. By default,
        values in the heat map are mapped to colors
        using the minimum and maximum of each row independently.
        With z-scored data, a fixed scale should be used. Set the range of the fixed color scale to -2, 2.

        <br/><a target="_blank" href="https://youtu.be/zIEHPaz7PhY">Video <i
          class="fa fa-video-camera" aria-hidden="true"></i></a></p>


      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Add Cell Line Annotations</a>
      <p class="collapse">Download the <a target="_blank" href="https://ndownloader.figshare.com/files/16757723">cell
        line metadata</a>. Select File > Open
        and then select "Annotate Columns"
        for "Open File Action". Next go to View > Options and select the Annotations tab. Select "id", "lineage", and
        "sample_collection_site" for
        column annotations.</p>


      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Variance</a>
      <p class="collapse">
        Click Tools > Create Calculated Annotation. <br/> Enter "variance" for
        the "Annotation name". <br/> Enter "VARIANCE()" for "Formula" and
        click "OK". <br/> A new row annotation named "variance" will appear to
        the right of the heat map.
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Filter
        Rows</a>
      <p class="collapse">
        Show only the top 500 most variable genes by variance <br/> Click Tools > Filter to open the filter dialog.
        <br/>Click the "Add"
        button and set the field name to "variance". <br/>Click
        "Switch to top N filter" and enter "500" for "N".
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Hierarchical
        Clustering</a>
      <p class="collapse">
        Click Tools > Hierarchical Clustering. Change "Cluster" to "Rows and
        columns". Click "OK" to run the analysis. <br/> Do haematopoietic
        cell lines cluster together? Try searching the columns for "haematopoietic_and_lymphoid_tissue". Right-click on
        the sample_collection_site header
        and select "Highlight matching values". Hover over the sample_collection_site
        values to highlight cell lines from the same site. You
        can dynamically cut the dendrogram by dragging the dashed line at
        the top of the dendrogram. <br/>Hierarchical clustering
        recursively merges objects based on their pair-wise distance.
        Objects closest together are merged first, objects furthest apart
        are merged last. The result is a tree structure, referred to as a
        dendogram, where the leaf nodes represent the original items and
        internal (higher) nodes represent the merges that occurred. Click <a
        target="_black"
        href="http://www.mathworks.com/help/stats/hierarchical-clustering.html">here</a>
        for a more detailed description of the hierarchical clustering
        algorithm and <a target="_blank"
                         href="http://support.minitab.com/en-us/minitab-express/1/help-and-how-to/modeling-statistics/regression/supporting-topics/basics/a-comparison-of-the-pearson-and-spearman-correlation-methods/">here</a>
        for a comparison of the Pearson and Spearman correlation methods.
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Compress
        Heat Map</a>
      <p class="collapse">
        Click View > Fit To Window to compress the heat map. Select View > 100%
        to return to the original heat map size.
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Remove
        Row Filter</a>
      <p class="collapse">
        Select Tools > Filter and delete the variance filter to show all
        rows.
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Remove
        Dendrograms</a>
      <p class="collapse">Right-click on the column dendrogram and
        select "Delete". Do the same for the row dendrogram.</p>


      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Sort
        Rows</a>
      <p class="collapse">
        Click the variance row annotation header in the heat map once to sort
        the heat map in ascending order by the variance.
        Click it again to sort the heat map in descending. The third click sorts by alternating groups of ten of most
        similar and dissimilar items.
        Note that you can shift-click to sort multiple columns simultaneously.
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Search
        Results To Top</a>
      <p class="collapse">
        Enter "BRAF" in the row search box. <br/> Click
        <button type="button" class="btn btn-default btn-xs">
          <i class="fa fa-level-up"></i>
        </button>
        to bring the matches to the top of the heat map.
      </p>


      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Visual
        Enrichment</a>
      <p class="collapse">
        Double-click on BRAF row to sort by dependency score. <br/>
        Search columns for "skin". <br/> Do skin cell lines seem to be
        more dependent on BRAF than cell lines from other lineages? <br/>
        You can optionally limit your search to within a field by typing
        the field name followed by a colon ":" and then the term you are
        looking for.

      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Nearest
        Neighbors</a>
      <p class="collapse">
        Click Tools > Nearest Neighbors. Click "OK" to run the analysis. <br/>
        A new row annotation named "Pearson correlation" will appear. <br/>
        What genes correlate with BRAF?
      </p>


      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Append Dataset</a>
      <p class="collapse">
        Download the PRISM <a target="_blank" href="https://ndownloader.figshare.com/files/17008628">drug sensitivity
        data</a> and select File > Open. Open the dataset in a new tab.
        Select Tools > Transpose to put the compounds on the rows and the cell lines on the columns. Select File > Save
        Dataset to save the
        transposed matrix and enter "prism_logfold_change.gct" for the file name. Navigate back to the gene essentiality
        dataset tab. Select File > Open to open the transposed drug sensitivity matrix. Change "Open File Action" to
        "Append rows to
        current dataset". Match the cell line ids in the CRISPR dataset with the cell line ids in the drug sensitivity
        dataset.
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Repeat Nearest
        Neighbors With drug sensitivity dataset</a>
      <p class="collapse">
        Create a new tab with BRAF CRISPR dependency scores and drug sensitivity scores by searching rows for
        "Source:prism_logfold_change BRAF". Ensure that all columns are selected. Click Tools > New Heat Map to
        create a new tab.
        Download the <a target="_blank"
                        href="https://ndownloader.figshare.com/files/17008634">compound
        annotations</a> and select File > Open. Choose "Annotate rows" for "Open File Action".
        In the new tab, search for BRAF and bring the matches to the top. Select the BRAF dependency scores. Click Tools
        > Nearest Neighbors.
        Click "OK" to run the analysis. <br/>

        A new row annotation named "Pearson correlation" will appear. <br/>
        What drugs correlate with BRAF dependency scores?
      </p>

      <a data-toggle="collapse"
         style="font-size: 1.2em; display: block; font-weight: 800;">Overlay RNAi data on top of CRISPR data to create
        dot plots</a>
      <p class="collapse">

        Create a new tab with the CRISPR dependency scores only. Remove the number after the gene name by selecting
        Tools>Create Calculated Annotation. Enter "id_stripped" for the annotation
        name and FIELD('id').substring(0, FIELD('id').indexOf('(')) for the formula.
        <br/>Download the <a
        href="https://ndownloader.figshare.com/files/11489669">RNAi dataset</a> and select File>Open. Repeat the same
        process
        to remove the numbers after the gene name by selecting
        Tools>Create Calculated Annotation. Enter "id_stripped" for the annotation
        name and FIELD('id').substring(0, FIELD('id').indexOf('(')) for the formula. Select File > Save
        Dataset to save the updated dataset and enter "D2_Achilles_gene_dep_scores.gct" for the file name. Navigate back
        to the
        CRISPR tab and select File > Open. Change "Open File
        Action" to "Overlay onto
        current dataset". Match the "CCLE Name" in the CRISPR dataset with "id" in the RNAi
        dataset and the "id_stripped" annotation in the CRISPR dataset with "id_stripped" in the RNAi dataset. Select
        View > Options to
        edit the color scale. Change "shape" to "circle" and "size by" to the RNAi dataset. Set the size by minimum to 2
        and the maximum to -2.
      </p>


    </div>
  </div>
  <div class="row"></div>
  <div class="row"></div>
  <div class="row"></div>
  <div class="row"></div>
  <div class="row"></div>
  <div class="row"></div>
  <div class="row">
    <div class="col-xs-12 morpheus-footer"></div>
  </div>
</div>
<script type="text/javascript">new morpheus.HelpMenu().$el.appendTo($('.morpheus-footer'));
var links = $(document.body).find('[data-toggle=collapse]');
var collapse = $(document.body).find('.collapse');
for (var i = 0; i < collapse.length; i++) {
    var $c = $(collapse[i]);
    var $l = $(links[i]);
    $l.html((i + 1) + '. ' + $l.html());
    $c.attr('id', i);
    $l.attr('href', '#' + i);
}
$('#header').find('[name=expand]').on('click', function () {
    $(document.body).find('.collapse').collapse('show');
});
$('#header').find('[name=collapse]').on('click', function () {
    $(document.body).find('.collapse').collapse('hide');
});
</script>
</body>
</html>
